import{S as ae,i as oe,s as ne,e as k,k as U,c as j,a as D,m as A,d as E,b as n,J as Z,g as K,K as _,$ as R,a0 as z,a1 as le,a2 as se,a3 as ie,a4 as re,a5 as $,T as ue,t as de,V as ce,h as fe,a6 as _e,p as he,q as pe,o as me,a7 as ve,a8 as x,n as be,a9 as ge,L as Ee}from"../../chunks/vendor-a72b8ec8.js";function B(u,{pending:t,error:e,result:a}){let h;async function T(p){const c=h={};p.preventDefault();const v=new FormData(u);t&&t(v,u);try{const i=await fetch(u.action,{method:u.method,headers:{accept:"application/json"},body:v});if(c!==h)return;i.ok?a(i,u):e?e(i,null,u):console.error(await i.text())}catch(i){if(e)e(null,i,u);else throw i}}return u.addEventListener("submit",T),{destroy(){u.removeEventListener("submit",T)}}}function ee(u,t,e){const a=u.slice();return a[6]=t[e],a[7]=t,a[8]=e,a}function te(u,t){let e,a,h,T,p,c,v,i,o,m,f,b,P,M,O,s,r,l,w,F,C,H,q,N,S,V=Ee,y,J,G;function Q(...g){return t[3](t[6],t[7],t[8],...g)}function W(){return t[4](t[6],t[7],t[8])}function X(){return t[5](t[6])}return{key:u,first:null,c(){e=k("div"),a=k("form"),h=k("input"),p=U(),c=k("button"),m=U(),f=k("form"),b=k("input"),M=U(),O=k("button"),r=U(),l=k("form"),w=k("button"),q=U(),this.h()},l(g){e=j(g,"DIV",{class:!0});var d=D(e);a=j(d,"FORM",{action:!0,method:!0});var I=D(a);h=j(I,"INPUT",{type:!0,name:!0,class:!0}),p=A(I),c=j(I,"BUTTON",{class:!0,"aria-label":!0}),D(c).forEach(E),I.forEach(E),m=A(d),f=j(d,"FORM",{class:!0,action:!0,method:!0});var L=D(f);b=j(L,"INPUT",{"aria-label":!0,type:!0,name:!0,class:!0}),M=A(L),O=j(L,"BUTTON",{class:!0,"aria-label":!0}),D(O).forEach(E),L.forEach(E),r=A(d),l=j(d,"FORM",{action:!0,method:!0});var Y=D(l);w=j(Y,"BUTTON",{class:!0,"aria-label":!0}),D(w).forEach(E),Y.forEach(E),q=A(d),d.forEach(E),this.h()},h(){n(h,"type","hidden"),n(h,"name","done"),h.value=T=t[6].done?"":"true",n(h,"class","svelte-1ficitt"),n(c,"class","toggle svelte-1ficitt"),n(c,"aria-label",v="Mark todo as "+(t[6].done?"not done":"done")),n(a,"action",i="/todos/"+t[6].uid+".json?_method=PATCH"),n(a,"method","post"),n(b,"aria-label","Edit todo"),n(b,"type","text"),n(b,"name","text"),b.value=P=t[6].text,n(b,"class","svelte-1ficitt"),n(O,"class","save svelte-1ficitt"),n(O,"aria-label","Save todo"),n(f,"class","text svelte-1ficitt"),n(f,"action",s="/todos/"+t[6].uid+".json?_method=PATCH"),n(f,"method","post"),n(w,"class","delete svelte-1ficitt"),n(w,"aria-label","Delete todo"),w.disabled=F=t[6].pending_delete,n(l,"action",C="/todos/"+t[6].uid+".json?_method=DELETE"),n(l,"method","post"),n(e,"class","todo svelte-1ficitt"),Z(e,"done",t[6].done),this.first=e},m(g,d){K(g,e,d),_(e,a),_(a,h),_(a,p),_(a,c),_(e,m),_(e,f),_(f,b),_(f,M),_(f,O),_(e,r),_(e,l),_(l,w),_(e,q),y=!0,J||(G=[R(o=B.call(null,a,{pending:Q,result:t[1]})),R(B.call(null,f,{result:t[1]})),R(H=B.call(null,l,{pending:W,result:X}))],J=!0)},p(g,d){t=g,(!y||d&1&&T!==(T=t[6].done?"":"true"))&&(h.value=T),(!y||d&1&&v!==(v="Mark todo as "+(t[6].done?"not done":"done")))&&n(c,"aria-label",v),(!y||d&1&&i!==(i="/todos/"+t[6].uid+".json?_method=PATCH"))&&n(a,"action",i),o&&z(o.update)&&d&1&&o.update.call(null,{pending:Q,result:t[1]}),(!y||d&1&&P!==(P=t[6].text)&&b.value!==P)&&(b.value=P),(!y||d&1&&s!==(s="/todos/"+t[6].uid+".json?_method=PATCH"))&&n(f,"action",s),(!y||d&1&&F!==(F=t[6].pending_delete))&&(w.disabled=F),(!y||d&1&&C!==(C="/todos/"+t[6].uid+".json?_method=DELETE"))&&n(l,"action",C),H&&z(H.update)&&d&1&&H.update.call(null,{pending:W,result:X}),d&1&&Z(e,"done",t[6].done)},r(){S=e.getBoundingClientRect()},f(){le(e),V(),se(e,S)},a(){V(),V=ie(e,S,ve,{duration:200})},i(g){y||(g&&re(()=>{N||(N=$(e,x,{start:.7},!0)),N.run(1)}),y=!0)},o(g){g&&(N||(N=$(e,x,{start:.7},!1)),N.run(0)),y=!1},d(g){g&&E(e),g&&N&&N.end(),J=!1,ue(G)}}}function Te(u){let t,e,a,h,T,p,c,v,i,o=[],m=new Map,f,b,P,M=u[0];const O=s=>s[6].uid;for(let s=0;s<M.length;s+=1){let r=ee(u,M,s),l=O(r);m.set(l,o[s]=te(l,r))}return{c(){t=U(),e=k("div"),a=k("h1"),h=de("Todos"),T=U(),p=k("form"),c=k("input"),i=U();for(let s=0;s<o.length;s+=1)o[s].c();this.h()},l(s){ce('[data-svelte="svelte-181o7gf"]',document.head).forEach(E),t=A(s),e=j(s,"DIV",{class:!0});var l=D(e);a=j(l,"H1",{});var w=D(a);h=fe(w,"Todos"),w.forEach(E),T=A(l),p=j(l,"FORM",{class:!0,action:!0,method:!0});var F=D(p);c=j(F,"INPUT",{name:!0,"aria-label":!0,placeholder:!0,class:!0}),F.forEach(E),i=A(l);for(let C=0;C<o.length;C+=1)o[C].l(l);l.forEach(E),this.h()},h(){document.title="Todos",n(c,"name","text"),n(c,"aria-label","Add todo"),n(c,"placeholder","+ tap to add a todo"),n(c,"class","svelte-1ficitt"),n(p,"class","new svelte-1ficitt"),n(p,"action","/todos.json"),n(p,"method","post"),n(e,"class","todos svelte-1ficitt")},m(s,r){K(s,t,r),K(s,e,r),_(e,a),_(a,h),_(e,T),_(e,p),_(p,c),_(e,i);for(let l=0;l<o.length;l+=1)o[l].m(e,null);f=!0,b||(P=R(v=B.call(null,p,{result:u[2]})),b=!0)},p(s,[r]){if(v&&z(v.update)&&r&1&&v.update.call(null,{result:s[2]}),r&3){M=s[0],be();for(let l=0;l<o.length;l+=1)o[l].r();o=_e(o,r,O,1,s,M,m,e,ge,te,null,ee);for(let l=0;l<o.length;l+=1)o[l].a();he()}},i(s){if(!f){for(let r=0;r<M.length;r+=1)pe(o[r]);f=!0}},o(s){for(let r=0;r<o.length;r+=1)me(o[r]);f=!1},d(s){s&&E(t),s&&E(e);for(let r=0;r<o.length;r+=1)o[r].d();b=!1,P()}}}const we=async({fetch:u})=>{const t=await u("/todos.json");if(t.ok)return{props:{todos:await t.json()}};const{message:e}=await t.json();return{error:new Error(e)}};function ke(u,t,e){let{todos:a}=t;async function h(i){const o=await i.json();e(0,a=a.map(m=>m.uid===o.uid?o:m))}const T=async(i,o)=>{const m=await i.json();e(0,a=[...a,m]),o.reset()},p=(i,o,m,f)=>{e(0,o[m].done=!!f.get("done"),a)},c=(i,o,m)=>e(0,o[m].pending_delete=!0,a),v=i=>{e(0,a=a.filter(o=>o.uid!==i.uid))};return u.$$set=i=>{"todos"in i&&e(0,a=i.todos)},[a,h,T,p,c,v]}class ye extends ae{constructor(t){super();oe(this,t,ke,Te,ne,{todos:0})}}export{ye as default,we as load};
